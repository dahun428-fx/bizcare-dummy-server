# ê²Œì‹œíŒ ì„œë²„ ë¦¬íŒ©í† ë§

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
bizcare-dummy-server/
â”œâ”€â”€ server.js                 # ë©”ì¸ ì„œë²„ íŒŒì¼ (ê¸°ì¡´)
â”œâ”€â”€ server-backup.js          # ë°±ì—… íŒŒì¼
â”œâ”€â”€ server-refactored.js      # ë¦¬íŒ©í† ë§ëœ ì„œë²„ (ì„ íƒì  ì‚¬ìš©)
â”œâ”€â”€ board-data.json           # ë°ì´í„° íŒŒì¼
â”œâ”€â”€ uploads/                  # ì—…ë¡œë“œ íŒŒì¼ë“¤
â”‚   â”œâ”€â”€ thumbnails/
â”‚   â””â”€â”€ attachments/
â””â”€â”€ src/                      # ëª¨ë“ˆí™”ëœ ì½”ë“œ
    â”œâ”€â”€ config/
    â”‚   â””â”€â”€ constants.js      # ì„¤ì • ìƒìˆ˜
    â”œâ”€â”€ middleware/
    â”‚   â”œâ”€â”€ logger.js         # ìš”ì²­ ë¡œê¹…
    â”‚   â””â”€â”€ upload.js         # íŒŒì¼ ì—…ë¡œë“œ ì„¤ì •
    â”œâ”€â”€ utils/
    â”‚   â”œâ”€â”€ fileUtils.js      # íŒŒì¼ ê´€ë ¨ ìœ í‹¸ë¦¬í‹°
    â”‚   â”œâ”€â”€ jsonUtils.js      # JSON íŒŒì¼ ì½ê¸°/ì“°ê¸°
    â”‚   â””â”€â”€ boardHelpers.js   # ê²Œì‹œê¸€ ì²˜ë¦¬ í—¬í¼ í•¨ìˆ˜ë“¤
    â””â”€â”€ routes/               # API ë¼ìš°íŠ¸ (ì¤€ë¹„ì¤‘)
        â”œâ”€â”€ auth.js
        â”œâ”€â”€ board.js
        â”œâ”€â”€ adminBoard.js
        â”œâ”€â”€ comments.js
        â”œâ”€â”€ likes.js
        â””â”€â”€ files.js
```

## âœ¨ ë¦¬íŒ©í† ë§ ê°œì„  ì‚¬í•­

### 1. **ëª¨ë“ˆí™”**
- ì„¤ì •, ìœ í‹¸ë¦¬í‹°, ë¯¸ë“¤ì›¨ì–´ë¥¼ ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬
- ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í•¨ìˆ˜ë“¤ì„ í—¬í¼ ëª¨ë“ˆë¡œ ì¶”ì¶œ

### 2. **ì¤‘ë³µ ì½”ë“œ ì œê±°**
- ê³µí†µ íŒŒì¼ ì²˜ë¦¬ ë¡œì§ì„ `boardHelpers.js`ë¡œ í†µí•©
- ì¸ë„¤ì¼/ì²¨ë¶€íŒŒì¼ ì²˜ë¦¬ í•¨ìˆ˜ ì¬ì‚¬ìš©

### 3. **ê°€ë…ì„± í–¥ìƒ**
- í•¨ìˆ˜ëª…ì„ ëª…í™•í•˜ê²Œ ì‘ì„± (ì˜ˆ: `addDomainToUrls`, `processThumbnail`)
- JSDoc ì£¼ì„ ì¶”ê°€ë¡œ í•¨ìˆ˜ ì„¤ëª… ì œê³µ

### 4. **ìœ ì§€ë³´ìˆ˜ì„± ê°œì„ **
- ì„¤ì •ê°’ì„ `constants.js`ë¡œ ì¤‘ì•™í™”
- ê° ëª¨ë“ˆì˜ ì±…ì„ì„ ëª…í™•í•˜ê²Œ ë¶„ë¦¬

## ğŸš€ ì‚¬ìš© ë°©ë²•

### ê¸°ì¡´ ë°©ì‹ (í˜„ì¬ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
```bash
node server.js
```

### ë¦¬íŒ©í† ë§ëœ ë°©ì‹ (ì„ íƒì )
```bash
# í—¬í¼ í•¨ìˆ˜ ì‚¬ìš© ì˜ˆì‹œ
const { processThumbnail, processUploadedFiles } = require('./src/utils/boardHelpers');

// ì¸ë„¤ì¼ ì²˜ë¦¬
const thumbnailPath = await processThumbnail(req, req.body.thumbnail);

// ì²¨ë¶€íŒŒì¼ ì²˜ë¦¬
const { uploaded, maxAttachmentId } = processUploadedFiles(req.files, currentMaxId);
```

## ğŸ“ ì£¼ìš” í—¬í¼ í•¨ìˆ˜

### `boardHelpers.js`

#### `addDomainToUrls(data, req)`
ê²Œì‹œê¸€ ë°ì´í„°ì˜ URLì— ë„ë©”ì¸ ì¶”ê°€

#### `processThumbnail(req, thumbnail)`
ì¸ë„¤ì¼ íŒŒì¼ ì²˜ë¦¬ (ì—…ë¡œë“œ ë˜ëŠ” ì™¸ë¶€ URL ë‹¤ìš´ë¡œë“œ)

#### `processUploadedFiles(files, maxAttachmentId)`
multerë¡œ ì—…ë¡œë“œëœ ì²¨ë¶€íŒŒì¼ ì²˜ë¦¬

#### `processAttachmentsParam(attachments, maxAttachmentId)`
attachments íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ëœ íŒŒì¼ ì²˜ë¦¬

#### `processDeletedAttachments(currentAttachments, deleted_attachments)`
ì‚­ì œí•  ì²¨ë¶€íŒŒì¼ í•„í„°ë§

#### `getMaxAttachmentId(boardData)`
í˜„ì¬ ìµœëŒ€ ì²¨ë¶€íŒŒì¼ ID ì°¾ê¸°

## ğŸ”„ ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

### 1ë‹¨ê³„: í—¬í¼ í•¨ìˆ˜ ì‚¬ìš© ì‹œì‘
ê¸°ì¡´ server.jsì˜ ì¤‘ë³µ ì½”ë“œë¥¼ í—¬í¼ í•¨ìˆ˜ë¡œ êµì²´

```javascript
// Before
if (req.files && req.files['thumbnail']) {
    const thumbnailFile = req.files['thumbnail'][0];
    // ... 10ì¤„ì˜ ì²˜ë¦¬ ì½”ë“œ
}

// After
const thumbnailPath = await processThumbnail(req, req.body.thumbnail);
```

### 2ë‹¨ê³„: ë¼ìš°íŠ¸ ë¶„ë¦¬
API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ë³„ë„ íŒŒì¼ë¡œ ì´ë™

### 3ë‹¨ê³„: ì„œë¹„ìŠ¤ ê³„ì¸µ ì¶”ê°€
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì„œë¹„ìŠ¤ íŒŒì¼ë¡œ ë¶„ë¦¬

## ğŸ“Š ì½”ë“œ í’ˆì§ˆ ê°œì„  ì§€í‘œ

| í•­ëª© | Before | After |
|------|--------|-------|
| íŒŒì¼ í¬ê¸° | 2178 ì¤„ | ëª¨ë“ˆí™” |
| ì¤‘ë³µ ì½”ë“œ | ë†’ìŒ | ë‚®ìŒ |
| ê°€ë…ì„± | ì¤‘ê°„ | ë†’ìŒ |
| ìœ ì§€ë³´ìˆ˜ì„± | ë‚®ìŒ | ë†’ìŒ |

## ğŸ”œ ë‹¤ìŒ ë‹¨ê³„

1. **í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±**
   - Jestë¥¼ ì‚¬ìš©í•œ ìœ ë‹› í…ŒìŠ¤íŠ¸
   - API ì—”ë“œí¬ì¸íŠ¸ í†µí•© í…ŒìŠ¤íŠ¸

2. **ë¬¸ì„œí™”**
   - Swagger/OpenAPIë¡œ API ë¬¸ì„œ ìë™ ìƒì„±
   - JSDocìœ¼ë¡œ í•¨ìˆ˜ ì„¤ëª… ì™„ì„±

3. **ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ **
   - ì»¤ìŠ¤í…€ ì—ëŸ¬ í´ë˜ìŠ¤ ì¶”ê°€
   - ì—ëŸ¬ ì²˜ë¦¬ ë¯¸ë“¤ì›¨ì–´ í†µí•©

4. **í™˜ê²½ ì„¤ì •**
   - `.env` íŒŒì¼ë¡œ í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬
   - ê°œë°œ/í”„ë¡œë•ì…˜ í™˜ê²½ ë¶„ë¦¬

5. **íƒ€ì… ì•ˆì •ì„±**
   - TypeScript ë„ì… ê³ ë ¤
   - ë˜ëŠ” JSDocìœ¼ë¡œ íƒ€ì… íŒíŠ¸ ì¶”ê°€

## ğŸ’¡ ì°¸ê³ ì‚¬í•­

- ê¸°ì¡´ `server.js`ëŠ” `server-backup.js`ë¡œ ë°±ì—…ë˜ì–´ ìˆìŠµë‹ˆë‹¤
- ì ì§„ì ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ì—¬ ë¦¬ìŠ¤í¬ë¥¼ ìµœì†Œí™”í•˜ì„¸ìš”
- ìƒˆë¡œìš´ ê¸°ëŠ¥ì€ ëª¨ë“ˆí™”ëœ êµ¬ì¡°ë¡œ ì¶”ê°€í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤
